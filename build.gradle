apply plugin: 'java'
apply plugin: 'maven'
apply plugin: 'idea'

group = 'beam'
version = '0.1.0-SNAPSHOT'

description = """"""

sourceCompatibility = 1.8
targetCompatibility = 1.8

repositories {
    maven { url "http://download.osgeo.org/webdav/geotools" }
    maven { url "http://repo.boundlessgeo.com/main/" }
    maven { url "https://repository.jboss.org/nexus/content/repositories/thirdparty-releases" }
    maven { url "http://central.maven.org/maven2"}
    maven { url "http://repo.maven.apache.org/maven2" }
    maven { url "http://dl.bintray.com/matsim/matsim" }
    maven { url "http://oss.jfrog.org/libs-snapshot" }
    jcenter()
    maven { url "https://jitpack.io" }
}

dependencies {
    compile group: 'org.apache.commons', name: 'commons-math3', version:'3.5'
    compile group: 'org.geotools', name: 'gt-epsg-wkt', version: '16.0'
    compile group: 'org.geotools', name: 'gt-shapefile', version:'16.0'
    compile group: 'junit', name: 'junit', version: '4.4'
    compile group: 'commons-io', name: 'commons-io', version: '2.5'
    compile group: 'com.esotericsoftware', name: 'kryo-shaded', version: '4.0.0'
    compile 'com.github.colinsheppard.matsim_all:matsim:master-SNAPSHOT'
    compile group: 'org.matsim.contrib', name: 'multimodal', version: '0.8.0'
    compile group: 'jgridshift', name: 'jgridshift', version: '1.0'
}

//////////////////////////////////////////////////////////////////////
// BUNDLING FOR EXECUTION
//
// Shadowjar bundles model together into executable jar
//////////////////////////////////////////////////////////////////////

buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'com.github.jengelman.gradle.plugins:shadow:1.2.3'
    }
}

apply plugin: 'com.github.johnrengelman.shadow'

jar {
   manifest {
       attributes 'Main-Class': 'beam.EVSimTeleController'
   }
}

shadowJar {
   baseName = 'beam'
   classifier = null
   version = null
}

task runBeam() {
    doLast {
        javaexec {
            classpath = sourceSets.main.runtimeClasspath

            main = 'beam.EVSimTeleController'

            args = [project.hasProperty('absPathToInputs') ? project.getProperty('absPathToInputs') : '',
                    project.hasProperty('relPathToConfig') ? project.getProperty('relPathToConfig') : '',
                    project.hasProperty('absPathToOutputs') ? project.getProperty('absPathToOutputs') : '']

            jvmArgs = [project.hasProperty('jvmArgs') ? project.getProperty('jvmArgs') : '']
        }
    }
}

